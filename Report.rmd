---
title: Income and Proximity to National Border's Influence on Burglary Rate in the
  Canton Zurich
author: "Holstein Thilo & Thalathara Hans"
date: "2026-01-26"
output:
  pdf_document:
    toc: true
    toc_depth: '3'
  html_document:
    toc: true
    toc_depth: 3
    number_sections: true
    theme: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(readr)
library(dplyr)
library(sf)
library(ggplot2)
```

# Introduction

Burglary patterns across Swiss municipalities have long been a subject of practical interest for law enforcement agencies. Anecdotal observations from the Canton of Basel-Landschaft suggest that burglaries may occur more frequently in wealthier municipalities, particularly those situated closer to Switzerland's international borders. While such observations are valuable for informing local police work, they raise broader questions about whether similar patterns exist elsewhere and what factors might explain them.
This analysis examines whether these observed trends hold in the Canton of Zurich by investigating the relationship between municipal burglary rates and two key variables: household income levels and proximity to national borders. Rather than assuming that Basel-Landschaft's patterns are universally applicable, we approach this as an empirical question and testing whether income and border proximity are associated with burglary rates in a different cantonal context. By doing so, we aim to move beyond localized observations toward a more systematic understanding of the spatial and socioeconomic factors that may influence property crime across Swiss municipalities.

## Research Question

How does income level and the proximity to the national borders relate to both crime rate (burglaries) across municipalities in Canton Zurich?

## Approach

We analyse open data from Canton Zurich to investigate a triangular relationship between income, proximity to Switzerland's national borders, and burglaries at the municipal level. By joining multiple datasets, we examine whether income predicts crime independently, and whether crime and accidents share a connection beyond what income alone explains.

## Hypotheses

**H1 – Income and Burglaries:**
Municipalities with higher median income exhibit higher burglary rates, as wealthier areas may present more attractive targets.

**H2 – National Border Proximity and Burglaries:**
Municipalities located closer to national borders may experience higher burglary rates due to reduced distances to potential escape routes across international boundaries.

# Data Sources

## Income Data

Median taxable income by municipality (Canton Zurich).

## Burglary Data

Burglary statistics by municipality (Canton Zurich).

## Additional Data

Geopackages of Swiss national borders, municipalities of the canton of Zurich and city districts of the city of Zurich

# Cleaning and Formatting the Dataset

## Data Formatting

Burglary data for the canton of Zurich were restricted to records representing total burglaries (“Einbrüche insgesamt”), which was the sum across different burglary types. Observations with unknown municipality names or unknown city districts were excluded. Variables related to legal references were removed, as they were not required for the analysis.

Median income data were integrated at two seperate spatial levels. At the municipality level, median income data from Canton Zurich were filtered to exclude cantonal aggregates and the city of Zurich itself. The dataset was reduced to essential variables: municipality identifier, name, year, and income value. At the city district level, median income data for the city of Zurich were filtered to include only the standard tax rate, and converted from thousands to actual values by multiplying the 50th percentile income by 1000.

Spatial boundary data for municipalities in the canton of Zurich were obtained from an official GeoPackage. Only geometries corresponding to municipalities were retained, while non-municipality and city-level geometries were excluded. The dataset was reduced to the municipality identifier and the corresponding geometry.

Swiss national border data were sourced from swisstopo and imported from a GeoPackage file. The data were filtered to retain only the Swiss national boundary. The polygon representation of the national territory was converted into a boundary line to enable distance calculations.

Prior to spatial analysis, all municipality geometries were transformed to a common coordinate reference system matching that of the Swiss border data. For each municipality, the centroid of the polygon geometry was computed. Euclidean distances from these centroids to the Swiss national border line were then calculated. Distances were stored in meters and additionally converted into kilometers for interpretability.

City district geometries for the city of Zurich were processed separately. Because the original dataset contained curved polygon geometries, the data were converted into standard multipolygon geometries using GDAL utilities. The converted geometries were subsequently imported, restricted to district identifiers and geometries, and transformed to the same coordinate reference system as the Swiss border data. Centroids were calculated for each city district, and distances to the Swiss national border were computed analogously to the municipality-level analysis, again expressed in both meters and kilometers.

```{r echo = FALSE, include = FALSE}
## Burglary data canton ZH
ebd <- read.csv("Data/KTZH_EBD.csv")

# Remove unnecessary records
ebd <- ebd %>% 
  filter(Tatbestand == 'Einbrüche insgesamt', 
         Gemeindename != "unbekannt ZH",
         Stadtkreis_Name != "unbekannt") %>% 
  select(-c(Gesetz_Nummer, Gesetz_Abk))

## Income data on municipality level
income_kt <- read.csv("Data/KTZH_Income_median.csv")

# Remove non-municipality and city data and unused columns
income_kt <- income_kt %>% 
  filter(!BFS_NR %in% c(0, 261)) %>% 
  select(BFS_NR, GEBIET_NAME, INDIKATOR_JAHR, INDIKATOR_VALUE) %>% 
  rename(INCOME_VALUE = INDIKATOR_VALUE)

## Income data on city district level
income_st <- read.csv("Data/STZH_Income_median.csv")

income_st <- income_st %>% 
  filter(SteuerTarifLang == "Grundtarif") %>% 
  select(-c("KreisSort", 
            "KreisCd", 
            "SteuerTarifSort", 
            "SteuerTarifCd",
            "SteuerTarifLang")) %>% 
  mutate(INCOME_VALUE = SteuerEinkommen_p50 * 1000)

# Read .gpkg of municipalities
ktzh_gpkg <- st_read("Data/KTZH_Gemeindegrenzen_OGD.gpkg", 
                             layer = "UP_GEMEINDEN_SEEN_F")

# Remove non-municipality and city geoms
ktzh_geom <- ktzh_gpkg %>% 
  filter(!ktzh_gpkg$BFS %in% c(0, 261), ktzh_gpkg$ART_CODE == 1) %>% 
  select(BFS, geom)

# Read .gpkg of swiss borders (swisstopo)
swiss_borders <- st_read("Data/CH_Borders_swisstopo.gpkg", 
                         layer = "tlm_landesgebiet")

swiss_borders <- swiss_borders %>% 
  filter(swiss_borders$icc == "CH")

# Calculate distance to border
swiss_border_line <- st_boundary(swiss_borders)

# Ensure same CRS
ktzh_geom <- st_transform(ktzh_geom, st_crs(swiss_borders))

# Calculate distance to border
ktzh_geom <- ktzh_geom %>% 
  st_transform(st_crs(swiss_borders)) %>%
  mutate(
    distance_to_border = st_distance(st_centroid(.), swiss_border_line)[,1],
    distance_to_border_km = as.numeric(distance_to_border) / 1000
  ) %>% 
  select(BFS, geom, distance_to_border, distance_to_border_km)

# Convert the city district .gpkg CURVEPOLYGON TO MULTIPOLYGON using gdal_utils
gdal_utils(
  util = "vectortranslate",
  source = "Data/STZH_Stadtkreise_OGD.gpkg",
  destination = "Data/STZH_lin.gpkg",
  options = c("-nlt", "MULTIPOLYGON", 
              "-lco", "GEOMETRY_NAME=geom",
              "-overwrite")
)

# Read the converted file
stzh_gpkg <- st_read("Data/STZH_lin.gpkg")

stzh_geom <- stzh_gpkg %>% 
  select(kname, geom) %>% 
  st_transform(st_crs(swiss_borders)) %>% 
  mutate(
    distance_to_border = st_distance(st_centroid(.), swiss_border_line)[,1],
    distance_to_border_km = as.numeric(distance_to_border) / 1000
  )
```

## Investigating Missing Values

## Joining the Datasets

```{r include = TRUE}
# Merge data sets
data <- ebd %>% 
  left_join(income_kt, 
            by = c("Gemeinde_BFS_Nr" = "BFS_NR",
                   "Ausgangsjahr" = "INDIKATOR_JAHR")) %>% 
  left_join(income_st %>% 
              select(KreisLang, StichtagDatJahr, INCOME_VALUE) %>% 
              rename(INCOME_VALUE_ST = INCOME_VALUE),
            by = c("Stadtkreis_Name" = "KreisLang",
                   "Ausgangsjahr" = "StichtagDatJahr")) %>% 
  mutate(INCOME_VALUE = if_else(!is.na(INCOME_VALUE_ST), 
                                INCOME_VALUE_ST, 
                                INCOME_VALUE)) %>% 
  select(-INCOME_VALUE_ST)

# Join geoms of the municipalities
data <- data %>% 
  left_join(ktzh_geom, by = c("Gemeinde_BFS_Nr" = "BFS"))

# Convert data's geometry to MULTIPOLYGON first
data <- data %>%
  mutate(geom = st_cast(geom, "MULTIPOLYGON"))

# Join and replace only the EMPTY geometries
data <- data %>%
  left_join(
    stzh_geom %>%
      select(kname, 
             geom_stzh = geom, 
             distance_to_border_stzh = distance_to_border, 
             distance_to_border_km_stzh = distance_to_border_km),
    by = c("Stadtkreis_Name" = "kname")
  ) %>%
  mutate(
    geom = if_else(st_is_empty(geom) & !is.na(geom_stzh), 
                   geom_stzh, 
                   geom),
    distance_to_border = coalesce(distance_to_border_stzh, distance_to_border),
    distance_to_border_km = coalesce(distance_to_border_km_stzh, distance_to_border_km)
  ) %>%
  select(-geom_stzh, -distance_to_border_stzh, -distance_to_border_km_stzh) %>%
  st_as_sf() %>% 
  mutate(Gemeinde_BFS_Nr = if_else(Gemeindename == "Zürich", 
                                   Stadtkreis_BFS_Nr, 
                                   Gemeinde_BFS_Nr))
```

# Exploratory Data Analysis

## Income Distribution

## Municipality Burglary Boxplots

## Burglary Rates by Municipality

```{r echo = FALSE, fig.show='hold'}
# City outline for map
# Create the outer boundary of Zurich city
city_outline <- data %>%
  filter(!is.na(Stadtkreis_BFS_Nr)) %>%
  st_union()  # Dissolves all districts into one polygon

# Get bounding box of municipalities
bbox <- st_bbox(ktzh_geom)
padding <- 5000  # in map units (meters for Swiss CRS)

# Plot the crime rate across whole data set
ebd_per_gmd <- data %>% 
  group_by(Gemeinde_BFS_Nr) %>% 
  mutate(Total_EBD = sum(Straftaten_total, na.rm = TRUE), 
         Einwohner_avg = mean(Einwohner, na.rm = TRUE),
         EBD_pop_ratio = Total_EBD / Einwohner_avg) %>% 
  summarise(across(c(geom, Einwohner_avg, Total_EBD, EBD_pop_ratio), first),
  .groups = "drop") %>% 
  st_as_sf()

ggplot() +
  geom_sf(data = swiss_borders, fill = NA, color = "black", linewidth = 1) +
  geom_sf(data = ebd_per_gmd, aes(fill = EBD_pop_ratio), color = "white", linewidth = 0.3) +
  geom_sf(data = city_outline, 
          fill = NA, 
          color = "black", 
          size = 0.5) +
  scale_fill_viridis_c(name = "EBD ratio per population") +
  coord_sf(xlim = c(bbox["xmin"] - padding, bbox["xmax"] + padding), 
           ylim = c(bbox["ymin"] - padding, bbox["ymax"] + padding)) +
  theme_minimal() +
  labs(title = "Number of Burglaries per Municipality by Population")
```

The city district Kreis 1 seems to be a strong outlier in the data. To have a more balanced output of the burglary rate per municipality and population, this is how the map of the canton of Zurich looks without the outlier:

```{r echo = FALSE}
ggplot() +
  geom_sf(data = swiss_borders, fill = NA, color = "black", linewidth = 1) +
  geom_sf(data = ebd_per_gmd %>% filter(Gemeinde_BFS_Nr != 2610001), aes(fill = EBD_pop_ratio), color = "white", linewidth = 0.3) +
  geom_sf(data = city_outline, 
          fill = NA, 
          color = "black", 
          size = 0.5) +
  scale_fill_viridis_c(name = "EBD ratio per population") +
  coord_sf(xlim = c(bbox["xmin"] - padding, bbox["xmax"] + padding), 
           ylim = c(bbox["ymin"] - padding, bbox["ymax"] + padding)) +
  theme_minimal() +
  labs(title = "Number of Burglaries per Municipality by Population (without Kreis 1)")
```

## Correlation Overview

# Modelling

## H1: Income and Burglaries

## H2: National Border Proximity and Burglaries

# Chapter of Choice

?shiny?

# Conclusions

## Key Findings

## Limitations

# Generative AI Reflection
